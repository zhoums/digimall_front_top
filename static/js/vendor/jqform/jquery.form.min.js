(function(e){"use strict";function t(t){var n=t.data;t.isDefaultPrevented()||(t.preventDefault(),e(this).ajaxSubmit(n))}function n(t){var n=t.target,a=e(n);if(!a.is("[type=submit],[type=image]")){var s=a.closest("[type=submit]");if(0===s.length)return;n=s[0]}var i=this;if(i.clk=n,"image"==n.type)if(void 0!==t.offsetX)i.clk_x=t.offsetX,i.clk_y=t.offsetY;else if("function"==typeof e.fn.offset){var r=a.offset();i.clk_x=t.pageX-r.left,i.clk_y=t.pageY-r.top}else i.clk_x=t.pageX-n.offsetLeft,i.clk_y=t.pageY-n.offsetTop;setTimeout(function(){i.clk=i.clk_x=i.clk_y=null},100)}function a(){if(e.fn.ajaxSubmit.debug){var t="[jquery.form] "+Array.prototype.join.call(arguments,"");window.console&&window.console.log?window.console.log(t):window.opera&&window.opera.postError&&window.opera.postError(t)}}var s={};s.fileapi=void 0!==e("<input type='file'/>").get(0).files,s.formdata=void 0!==window.FormData,e.fn.ajaxSubmit=function(t){function n(t){var n,a,s=e.param(t).split("&"),i=s.length,r={};for(n=0;i>n;n++)s[n]=s[n].replace(/\+/g," "),a=s[n].split("="),r[decodeURIComponent(a[0])]=decodeURIComponent(a[1]);return r}function i(a){for(var s=new FormData,i=0;a.length>i;i++)s.append(a[i].name,a[i].value);if(t.extraData){var r=n(t.extraData);for(var l in r)r.hasOwnProperty(l)&&s.append(l,r[l])}t.data=null;var c=e.extend(!0,{},e.ajaxSettings,t,{contentType:!1,processData:!1,cache:!1,type:o||"POST"});t.uploadProgress&&(c.xhr=function(){var e=jQuery.ajaxSettings.xhr();return e.upload&&(e.upload.onprogress=function(e){var n=0,a=e.loaded||e.position,s=e.total;e.lengthComputable&&(n=Math.ceil(100*(a/s))),t.uploadProgress(e,a,s,n)}),e}),c.data=null;var d=c.beforeSend;return c.beforeSend=function(e,t){t.data=s,d&&d.call(this,e,t)},e.ajax(c)}function r(n){function s(e){var t=e.contentWindow?e.contentWindow.document:e.contentDocument?e.contentDocument:e.document;return t}function i(){function t(){try{var e=s(v).readyState;a("state = "+e),e&&"uninitialized"==e.toLowerCase()&&setTimeout(t,50)}catch(n){a("Server abort: ",n," (",n.name,")"),r(L),x&&clearTimeout(x),x=void 0}}var n=d.attr("target"),i=d.attr("action");$.setAttribute("target",m),o||$.setAttribute("method","POST"),i!=f.url&&$.setAttribute("action",f.url),f.skipEncodingOverride||o&&!/post/i.test(o)||d.attr({encoding:"multipart/form-data",enctype:"multipart/form-data"}),f.timeout&&(x=setTimeout(function(){y=!0,r(j)},f.timeout));var l=[];try{if(f.extraData)for(var c in f.extraData)f.extraData.hasOwnProperty(c)&&(e.isPlainObject(f.extraData[c])&&f.extraData[c].hasOwnProperty("name")&&f.extraData[c].hasOwnProperty("value")?l.push(e('<input type="hidden" name="'+f.extraData[c].name+'">').val(f.extraData[c].value).appendTo($)[0]):l.push(e('<input type="hidden" name="'+c+'">').val(f.extraData[c]).appendTo($)[0]));f.iframeTarget||(p.appendTo("body"),v.attachEvent?v.attachEvent("onload",r):v.addEventListener("load",r,!1)),setTimeout(t,15),$.submit()}finally{$.setAttribute("action",i),n?$.setAttribute("target",n):d.removeAttr("target"),e(l).remove()}}function r(t){if(!C.aborted&&!P){try{D=s(v)}catch(n){a("cannot access response document: ",n),t=L}if(t===j&&C)return C.abort("timeout"),T.reject(C,"timeout"),void 0;if(t==L&&C)return C.abort("server abort"),T.reject(C,"error","server abort"),void 0;if(D&&D.location.href!=f.iframeSrc||y){v.detachEvent?v.detachEvent("onload",r):v.removeEventListener("load",r,!1);var i,o="success";try{if(y)throw"timeout";var l="xml"==f.dataType||D.XMLDocument||e.isXMLDoc(D);if(a("isXml="+l),!l&&window.opera&&(null===D.body||!D.body.innerHTML)&&--O)return a("requeing onLoad callback, DOM not available"),setTimeout(r,250),void 0;var c=D.body?D.body:D.documentElement;C.responseText=c?c.innerHTML:null,C.responseXML=D.XMLDocument?D.XMLDocument:D,l&&(f.dataType="xml"),C.getResponseHeader=function(e){var t={"content-type":f.dataType};return t[e]},c&&(C.status=Number(c.getAttribute("status"))||C.status,C.statusText=c.getAttribute("statusText")||C.statusText);var d=(f.dataType||"").toLowerCase(),m=/(json|script|text)/.test(d);if(m||f.textarea){var h=D.getElementsByTagName("textarea")[0];if(h)C.responseText=h.value,C.status=Number(h.getAttribute("status"))||C.status,C.statusText=h.getAttribute("statusText")||C.statusText;else if(m){var b=D.getElementsByTagName("pre")[0],g=D.getElementsByTagName("body")[0];b?C.responseText=b.textContent?b.textContent:b.innerText:g&&(C.responseText=g.textContent?g.textContent:g.innerText)}}else"xml"==d&&!C.responseXML&&C.responseText&&(C.responseXML=A(C.responseText));try{S=M(C,d,f)}catch(t){o="parsererror",C.error=i=t||o}}catch(t){a("error caught: ",t),o="error",C.error=i=t||o}C.aborted&&(a("upload aborted"),o=null),C.status&&(o=C.status>=200&&300>C.status||304===C.status?"success":"error"),"success"===o?(f.success&&f.success.call(f.context,S,"success",C),T.resolve(C.responseText,"success",C),u&&e.event.trigger("ajaxSuccess",[C,f])):o&&(void 0===i&&(i=C.statusText),f.error&&f.error.call(f.context,C,o,i),T.reject(C,"error",i),u&&e.event.trigger("ajaxError",[C,f,i])),u&&e.event.trigger("ajaxComplete",[C,f]),u&&!--e.active&&e.event.trigger("ajaxStop"),f.complete&&f.complete.call(f.context,C,o),P=!0,f.timeout&&clearTimeout(x),setTimeout(function(){f.iframeTarget||p.remove(),C.responseXML=null},100)}}}var l,c,f,u,m,p,v,C,b,g,y,x,$=d[0],k=!!e.fn.prop,T=e.Deferred();if(e("[name=submit],[id=submit]",$).length)return alert('Error: Form elements must not have name or id of "submit".'),T.reject(),T;if(n)for(c=0;h.length>c;c++)l=e(h[c]),k?l.prop("disabled",!1):l.removeAttr("disabled");if(f=e.extend(!0,{},e.ajaxSettings,t),f.context=f.context||f,m="jqFormIO"+(new Date).getTime(),f.iframeTarget?(p=e(f.iframeTarget),g=p.attr("name"),g?m=g:p.attr("name",m)):(p=e('<iframe name="'+m+'" src="'+f.iframeSrc+'" />'),p.css({position:"absolute",top:"-1000px",left:"-1000px"})),v=p[0],C={aborted:0,responseText:null,responseXML:null,status:0,statusText:"n/a",getAllResponseHeaders:function(){},getResponseHeader:function(){},setRequestHeader:function(){},abort:function(t){var n="timeout"===t?"timeout":"aborted";a("aborting upload... "+n),this.aborted=1;try{v.contentWindow.document.execCommand&&v.contentWindow.document.execCommand("Stop")}catch(s){}p.attr("src",f.iframeSrc),C.error=n,f.error&&f.error.call(f.context,C,n,t),u&&e.event.trigger("ajaxError",[C,f,n]),f.complete&&f.complete.call(f.context,C,n)}},u=f.global,u&&0===e.active++&&e.event.trigger("ajaxStart"),u&&e.event.trigger("ajaxSend",[C,f]),f.beforeSend&&f.beforeSend.call(f.context,C,f)===!1)return f.global&&e.active--,T.reject(),T;if(C.aborted)return T.reject(),T;b=$.clk,b&&(g=b.name,g&&!b.disabled&&(f.extraData=f.extraData||{},f.extraData[g]=b.value,"image"==b.type&&(f.extraData[g+".x"]=$.clk_x,f.extraData[g+".y"]=$.clk_y)));var j=1,L=2,w=e("meta[name=csrf-token]").attr("content"),I=e("meta[name=csrf-param]").attr("content");I&&w&&(f.extraData=f.extraData||{},f.extraData[I]=w),f.forceSync?i():setTimeout(i,10);var S,D,P,O=50,A=e.parseXML||function(e,t){return window.ActiveXObject?(t=new ActiveXObject("Microsoft.XMLDOM"),t.async="false",t.loadXML(e)):t=(new DOMParser).parseFromString(e,"text/xml"),t&&t.documentElement&&"parsererror"!=t.documentElement.nodeName?t:null},E=e.parseJSON||function(e){return window.eval("("+e+")")},M=function(t,n,a){var s=t.getResponseHeader("content-type")||"",i="xml"===n||!n&&s.indexOf("xml")>=0,r=i?t.responseXML:t.responseText;return i&&"parsererror"===r.documentElement.nodeName&&e.error&&e.error("parsererror"),a&&a.dataFilter&&(r=a.dataFilter(r,n)),"string"==typeof r&&("json"===n||!n&&s.indexOf("json")>=0?r=E(r):("script"===n||!n&&s.indexOf("javascript")>=0)&&e.globalEval(r)),r};return T}if(!this.length)return a("ajaxSubmit: skipping submit process - no element selected"),this;var o,l,c,d=this;"function"==typeof t&&(t={success:t}),o=this.attr("method"),l=this.attr("action"),c="string"==typeof l?e.trim(l):"",c=c||window.location.href||"",c&&(c=(c.match(/^([^#]+)/)||[])[1]),t=e.extend(!0,{url:c,success:e.ajaxSettings.success,type:o||"GET",iframeSrc:/^https/i.test(window.location.href||"")?"javascript:false":"about:blank"},t);var f={};if(this.trigger("form-pre-serialize",[this,t,f]),f.veto)return a("ajaxSubmit: submit vetoed via form-pre-serialize trigger"),this;if(t.beforeSerialize&&t.beforeSerialize(this,t)===!1)return a("ajaxSubmit: submit aborted via beforeSerialize callback"),this;var u=t.traditional;void 0===u&&(u=e.ajaxSettings.traditional);var m,h=[],p=this.formToArray(t.semantic,h);if(t.data&&(t.extraData=t.data,m=e.param(t.data,u)),t.beforeSubmit&&t.beforeSubmit(p,this,t)===!1)return a("ajaxSubmit: submit aborted via beforeSubmit callback"),this;if(this.trigger("form-submit-validate",[p,this,t,f]),f.veto)return a("ajaxSubmit: submit vetoed via form-submit-validate trigger"),this;var v=e.param(p,u);m&&(v=v?v+"&"+m:m),"GET"==t.type.toUpperCase()?(t.url+=(t.url.indexOf("?")>=0?"&":"?")+v,t.data=null):t.data=v;var C=[];if(t.resetForm&&C.push(function(){d.resetForm()}),t.clearForm&&C.push(function(){d.clearForm(t.includeHidden)}),!t.dataType&&t.target){var b=t.success||function(){};C.push(function(n){var a=t.replaceTarget?"replaceWith":"html";e(t.target)[a](n).each(b,arguments)})}else t.success&&C.push(t.success);t.success=function(e,n,a){for(var s=t.context||this,i=0,r=C.length;r>i;i++)C[i].apply(s,[e,n,a||d,d])};var g=e('input[type=file]:enabled[value!=""]',this),y=g.length>0,x="multipart/form-data",$=d.attr("enctype")==x||d.attr("encoding")==x,k=s.fileapi&&s.formdata;a("fileAPI :"+k);var T,j=(y||$)&&!k;t.iframe!==!1&&(t.iframe||j)?t.closeKeepAlive?e.get(t.closeKeepAlive,function(){T=r(p)}):T=r(p):T=(y||$)&&k?i(p):e.ajax(t),d.removeData("jqxhr").data("jqxhr",T);for(var L=0;h.length>L;L++)h[L]=null;return this.trigger("form-submit-notify",[this,t]),this},e.fn.ajaxForm=function(s){if(s=s||{},s.delegation=s.delegation&&e.isFunction(e.fn.on),!s.delegation&&0===this.length){var i={s:this.selector,c:this.context};return!e.isReady&&i.s?(a("DOM not ready, queuing ajaxForm"),e(function(){e(i.s,i.c).ajaxForm(s)}),this):(a("terminating; zero elements found by selector"+(e.isReady?"":" (DOM not ready)")),this)}return s.delegation?(e(document).off("submit.form-plugin",this.selector,t).off("click.form-plugin",this.selector,n).on("submit.form-plugin",this.selector,s,t).on("click.form-plugin",this.selector,s,n),this):this.ajaxFormUnbind().bind("submit.form-plugin",s,t).bind("click.form-plugin",s,n)},e.fn.ajaxFormUnbind=function(){return this.unbind("submit.form-plugin click.form-plugin")},e.fn.formToArray=function(t,n){var a=[];if(0===this.length)return a;var i=this[0],r=t?i.getElementsByTagName("*"):i.elements;if(!r)return a;var o,l,c,d,f,u,m;for(o=0,u=r.length;u>o;o++)if(f=r[o],c=f.name)if(t&&i.clk&&"image"==f.type)f.disabled||i.clk!=f||(a.push({name:c,value:e(f).val(),type:f.type}),a.push({name:c+".x",value:i.clk_x},{name:c+".y",value:i.clk_y}));else if(d=e.fieldValue(f,!0),d&&d.constructor==Array)for(n&&n.push(f),l=0,m=d.length;m>l;l++)a.push({name:c,value:d[l]});else if(s.fileapi&&"file"==f.type&&!f.disabled){n&&n.push(f);var h=f.files;if(h.length)for(l=0;h.length>l;l++)a.push({name:c,value:h[l],type:f.type});else a.push({name:c,value:"",type:f.type})}else null!==d&&d!==void 0&&(n&&n.push(f),a.push({name:c,value:d,type:f.type,required:f.required}));if(!t&&i.clk){var p=e(i.clk),v=p[0];c=v.name,c&&!v.disabled&&"image"==v.type&&(a.push({name:c,value:p.val()}),a.push({name:c+".x",value:i.clk_x},{name:c+".y",value:i.clk_y}))}return a},e.fn.formSerialize=function(t){return e.param(this.formToArray(t))},e.fn.fieldSerialize=function(t){var n=[];return this.each(function(){var a=this.name;if(a){var s=e.fieldValue(this,t);if(s&&s.constructor==Array)for(var i=0,r=s.length;r>i;i++)n.push({name:a,value:s[i]});else null!==s&&s!==void 0&&n.push({name:this.name,value:s})}}),e.param(n)},e.fn.fieldValue=function(t){for(var n=[],a=0,s=this.length;s>a;a++){var i=this[a],r=e.fieldValue(i,t);null===r||void 0===r||r.constructor==Array&&!r.length||(r.constructor==Array?e.merge(n,r):n.push(r))}return n},e.fieldValue=function(t,n){var a=t.name,s=t.type,i=t.tagName.toLowerCase();if(void 0===n&&(n=!0),n&&(!a||t.disabled||"reset"==s||"button"==s||("checkbox"==s||"radio"==s)&&!t.checked||("submit"==s||"image"==s)&&t.form&&t.form.clk!=t||"select"==i&&-1==t.selectedIndex))return null;if("select"==i){var r=t.selectedIndex;if(0>r)return null;for(var o=[],l=t.options,c="select-one"==s,d=c?r+1:l.length,f=c?r:0;d>f;f++){var u=l[f];if(u.selected){var m=u.value;if(m||(m=u.attributes&&u.attributes.value&&!u.attributes.value.specified?u.text:u.value),c)return m;o.push(m)}}return o}return e(t).val()},e.fn.clearForm=function(t){return this.each(function(){e("input,select,textarea",this).clearFields(t)})},e.fn.clearFields=e.fn.clearInputs=function(t){var n=/^(?:color|date|datetime|email|month|number|password|range|search|tel|text|time|url|week)$/i;return this.each(function(){var a=this.type,s=this.tagName.toLowerCase();n.test(a)||"textarea"==s?this.value="":"checkbox"==a||"radio"==a?this.checked=!1:"select"==s?this.selectedIndex=-1:"file"==a?e.browser.msie?e(this).replaceWith(e(this).clone()):e(this).val(""):t&&(t===!0&&/hidden/.test(a)||"string"==typeof t&&e(this).is(t))&&(this.value="")})},e.fn.resetForm=function(){return this.each(function(){("function"==typeof this.reset||"object"==typeof this.reset&&!this.reset.nodeType)&&this.reset()})},e.fn.enable=function(e){return void 0===e&&(e=!0),this.each(function(){this.disabled=!e})},e.fn.selected=function(t){return void 0===t&&(t=!0),this.each(function(){var n=this.type;if("checkbox"==n||"radio"==n)this.checked=t;else if("option"==this.tagName.toLowerCase()){var a=e(this).parent("select");t&&a[0]&&"select-one"==a[0].type&&a.find("option").selected(!1),this.selected=t}})},e.fn.ajaxSubmit.debug=!1})(jQuery);